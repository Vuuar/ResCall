(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[52],{9806:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/subscription",function(){return t(5135)}])},5135:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var r=t(1527),n=t(959),i=t(8391),a=t.n(i),o=t(8896),c=t(4995);let l=[{id:"basic",name:"Basic",description:"Perfect for small businesses just getting started",price:19,features:["Up to 50 appointments per month","Up to 5 services","Text message support","Appointment reminders","Basic analytics"],limits:{appointments:50,services:5,staff:1,voice_messages:!1,calendar_integration:!1,analytics:!1}},{id:"pro",name:"Pro",description:"For growing businesses with more clients",price:49,features:["Up to 200 appointments per month","Up to 15 services","Text & voice message support","Appointment reminders","Calendar integration","Advanced analytics"],limits:{appointments:200,services:15,staff:3,voice_messages:!0,calendar_integration:!0,analytics:!0},recommended:!0},{id:"premium",name:"Premium",description:"For established businesses with high volume",price:99,features:["Unlimited appointments","Unlimited services","Text & voice message support","Appointment reminders","Calendar integration","Advanced analytics","Multiple staff members","Priority support"],limits:{appointments:1/0,services:1/0,staff:10,voice_messages:!0,calendar_integration:!0,analytics:!0}}];var d=t(8720),m=t(8563),u=t(1669);function p(e){let{user:s}=e;(0,o.useRouter)();let[t,i]=(0,n.useState)(!1),[p,x]=(0,n.useState)(null),[h,f]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(s){var e;if(x(null!==(e=s.subscription_tier)&&void 0!==e?e:null),s.trial_ends_at){let e=new Date(s.trial_ends_at),t=new Date,r=e.getTime()-t.getTime(),n=Math.ceil(r/864e5);f(n>0?n:0)}}},[s]);let b=async e=>{if(!s){m.ZP.error("Vous devez \xeatre connect\xe9 pour vous abonner");return}i(!0);try{let{data:t}=await u.Z.post("/api/stripe/create-checkout-session",{planId:e,userId:s.id});window.location.href=t.url}catch(e){console.error("Error creating checkout session:",e),m.ZP.error("Une erreur est survenue lors de la cr\xe9ation de la session de paiement")}finally{i(!1)}},g=async()=>{if(!s||!s.stripe_customer_id){m.ZP.error("Aucun abonnement actif trouv\xe9");return}i(!0);try{let{data:e}=await u.Z.post("/api/stripe/create-portal-session",{customerId:s.stripe_customer_id});window.location.href=e.url}catch(e){console.error("Error creating portal session:",e),m.ZP.error("Une erreur est survenue lors de la cr\xe9ation de la session de gestion")}finally{i(!1)}};return s?(0,r.jsxs)(c.Z,{user:s,children:[(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:"Abonnement | WhatsApp Booking Assistant"})}),(0,r.jsxs)("div",{className:"py-6",children:[(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8",children:(0,r.jsx)("h1",{className:"text-2xl font-semibold text-secondary-900",children:"Abonnement"})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8 mt-6",children:[(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg mb-8 p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-secondary-900 mb-4",children:"Statut de votre abonnement"}),"active"===s.subscription_status?(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm text-secondary-700",children:["Vous \xeates actuellement abonn\xe9 au plan ",(0,r.jsx)("span",{className:"font-semibold",children:p}),"."]}),(0,r.jsx)("button",{onClick:g,disabled:t,className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:t?"Chargement...":"G\xe9rer mon abonnement"})]}):null!==h&&h>0?(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm text-secondary-700",children:["Vous \xeates en p\xe9riode d'essai. Il vous reste ",(0,r.jsxs)("span",{className:"font-semibold",children:[h," jours"]}),"."]}),(0,r.jsx)("p",{className:"text-sm text-secondary-500 mt-2",children:"Choisissez un plan ci-dessous pour continuer \xe0 utiliser le service apr\xe8s votre p\xe9riode d'essai."})]}):(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-sm text-secondary-700",children:"Vous n'avez pas d'abonnement actif. Choisissez un plan ci-dessous pour commencer."})})]}),(0,r.jsx)("div",{className:"space-y-12 lg:space-y-0 lg:grid lg:grid-cols-3 lg:gap-x-6",children:l.map(e=>(0,r.jsxs)("div",{className:"relative p-6 bg-white border rounded-lg shadow-sm flex flex-col ".concat(e.recommended?"border-primary-500 ring-2 ring-primary-500":"border-secondary-200"),children:[e.recommended&&(0,r.jsx)("div",{className:"absolute top-0 right-0 -mt-3 mr-6 px-3 py-1 bg-primary-500 text-white text-xs font-medium rounded-full",children:"Recommand\xe9"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-secondary-900",children:e.name}),(0,r.jsx)("p",{className:"mt-2 text-base text-secondary-500",children:e.description}),(0,r.jsxs)("p",{className:"mt-4",children:[(0,r.jsxs)("span",{className:"text-4xl font-extrabold text-secondary-900",children:[e.price,"â‚¬"]}),(0,r.jsx)("span",{className:"text-base font-medium text-secondary-500",children:"/mois"})]}),(0,r.jsx)("ul",{className:"mt-6 space-y-4",children:e.features.map(e=>(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(d.Z,{className:"h-5 w-5 text-green-500","aria-hidden":"true"})}),(0,r.jsx)("p",{className:"ml-3 text-sm text-secondary-700",children:e})]},e))})]}),(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)("button",{onClick:()=>b(e.id),disabled:t||p===e.id&&"active"===s.subscription_status,className:"w-full inline-flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 ".concat(p===e.id&&"active"===s.subscription_status?"bg-secondary-400 cursor-not-allowed":(e.recommended,"bg-primary-600 hover:bg-primary-700")),children:t?"Chargement...":p===e.id&&"active"===s.subscription_status?"Plan actuel":"Choisir ce plan"})})]},e.id))})]})]})]}):null}}},function(e){e.O(0,[61,989,42,613,995,774,888,179],function(){return e(e.s=9806)}),_N_E=e.O()}]);