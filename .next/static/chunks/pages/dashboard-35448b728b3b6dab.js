(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{3391:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return t(7770)}])},7770:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return x}});var n=t(1527),d=t(959),r=t(8391),i=t.n(r),a=t(8061),l=t.n(a),o=t(2852),c=t(4995),m=t(390);function x(e){let{user:s}=e,[t,r]=(0,d.useState)({total_appointments:0,confirmed_appointments:0,cancelled_appointments:0,no_show_appointments:0,total_conversations:0,conversion_rate:0}),[a,x]=(0,d.useState)([]),[h,u]=(0,d.useState)([]),[v,p]=(0,d.useState)(!0);(0,d.useEffect)(()=>{s&&j()},[s]);let j=async()=>{p(!0);try{let{data:e,error:t}=await o.O.from("appointments").select("*").eq("professional_id",null==s?void 0:s.id).order("start_time",{ascending:!1}).limit(5);if(t)throw t;x(e||[]);let{data:n,error:d}=await o.O.from("conversations").select("*").eq("professional_id",null==s?void 0:s.id).order("updated_at",{ascending:!1}).limit(5);if(d)throw d;u(n||[]);let{data:i,error:a}=await o.O.from("appointments").select("*").eq("professional_id",null==s?void 0:s.id);if(a)throw a;let{data:l,error:c}=await o.O.from("conversations").select("*").eq("professional_id",null==s?void 0:s.id);if(c)throw c;let m=(null==i?void 0:i.filter(e=>"confirmed"===e.status||"completed"===e.status))||[],h=(null==i?void 0:i.filter(e=>"cancelled"===e.status))||[],v=(null==i?void 0:i.filter(e=>"no_show"===e.status))||[],p=(null==l?void 0:l.length)?Math.round((null==i?void 0:i.length)/(null==l?void 0:l.length)*100):0;r({total_appointments:(null==i?void 0:i.length)||0,confirmed_appointments:m.length,cancelled_appointments:h.length,no_show_appointments:v.length,total_conversations:(null==l?void 0:l.length)||0,conversion_rate:p})}catch(e){console.error("Error fetching dashboard data:",e)}finally{p(!1)}};return s?(0,n.jsxs)(c.Z,{user:s,children:[(0,n.jsx)(i(),{children:(0,n.jsx)("title",{children:"Tableau de bord | WhatsApp Booking Assistant"})}),(0,n.jsxs)("div",{className:"py-6",children:[(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8",children:(0,n.jsx)("h1",{className:"text-2xl font-semibold text-secondary-900",children:"Tableau de bord"})}),(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8",children:[(0,n.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mt-6",children:[(0,n.jsxs)("h2",{className:"text-lg font-medium text-secondary-900",children:["Bienvenue, ",s.full_name," \uD83D\uDC4B"]}),(0,n.jsx)("p",{className:"mt-1 text-sm text-secondary-500",children:"Voici un aper\xe7u de votre activit\xe9 r\xe9cente et de vos statistiques."}),"free_trial"===s.subscription_tier&&(0,n.jsx)("div",{className:"mt-4 bg-primary-50 p-4 rounded-md",children:(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("svg",{className:"h-5 w-5 text-primary-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2h-1V9z",clipRule:"evenodd"})})}),(0,n.jsxs)("div",{className:"ml-3 flex-1 md:flex md:justify-between",children:[(0,n.jsxs)("p",{className:"text-sm text-primary-700",children:["Votre p\xe9riode d'essai se termine le ",s.trial_ends_at?(0,m.p6)(s.trial_ends_at,"PPP"):"bient\xf4t","."]}),(0,n.jsx)("p",{className:"mt-3 text-sm md:mt-0 md:ml-6",children:(0,n.jsxs)(l(),{href:"/dashboard/subscription",className:"whitespace-nowrap font-medium text-primary-700 hover:text-primary-600",children:["Choisir un forfait ",(0,n.jsx)("span",{"aria-hidden":"true",children:"â†’"})]})})]})]})})]}),(0,n.jsxs)("div",{className:"mt-8 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:[(0,n.jsxs)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[(0,n.jsx)("div",{className:"p-5",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0 bg-primary-100 rounded-md p-3",children:(0,n.jsx)("svg",{className:"h-6 w-6 text-primary-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,n.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{className:"text-sm font-medium text-secondary-500 truncate",children:"Rendez-vous totaux"}),(0,n.jsx)("dd",{children:(0,n.jsx)("div",{className:"text-lg font-medium text-secondary-900",children:v?"...":t.total_appointments})})]})})]})}),(0,n.jsx)("div",{className:"bg-secondary-50 px-5 py-3",children:(0,n.jsx)("div",{className:"text-sm",children:(0,n.jsx)(l(),{href:"/dashboard/appointments",className:"font-medium text-primary-700 hover:text-primary-900",children:"Voir tous les rendez-vous"})})})]}),(0,n.jsxs)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[(0,n.jsx)("div",{className:"p-5",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0 bg-green-100 rounded-md p-3",children:(0,n.jsx)("svg",{className:"h-6 w-6 text-green-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,n.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{className:"text-sm font-medium text-secondary-500 truncate",children:"Rendez-vous confirm\xe9s"}),(0,n.jsx)("dd",{children:(0,n.jsx)("div",{className:"text-lg font-medium text-secondary-900",children:v?"...":t.confirmed_appointments})})]})})]})}),(0,n.jsx)("div",{className:"bg-secondary-50 px-5 py-3",children:(0,n.jsx)("div",{className:"text-sm",children:(0,n.jsx)(l(),{href:"/dashboard/appointments?status=confirmed",className:"font-medium text-primary-700 hover:text-primary-900",children:"Voir les d\xe9tails"})})})]}),(0,n.jsxs)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[(0,n.jsx)("div",{className:"p-5",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0 bg-primary-100 rounded-md p-3",children:(0,n.jsx)("svg",{className:"h-6 w-6 text-primary-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),(0,n.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{className:"text-sm font-medium text-secondary-500 truncate",children:"Conversations"}),(0,n.jsx)("dd",{children:(0,n.jsx)("div",{className:"text-lg font-medium text-secondary-900",children:v?"...":t.total_conversations})})]})})]})}),(0,n.jsx)("div",{className:"bg-secondary-50 px-5 py-3",children:(0,n.jsx)("div",{className:"text-sm",children:(0,n.jsx)(l(),{href:"/dashboard/conversations",className:"font-medium text-primary-700 hover:text-primary-900",children:"Voir toutes les conversations"})})})]}),(0,n.jsxs)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[(0,n.jsx)("div",{className:"p-5",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0 bg-yellow-100 rounded-md p-3",children:(0,n.jsx)("svg",{className:"h-6 w-6 text-yellow-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,n.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{className:"text-sm font-medium text-secondary-500 truncate",children:"Taux de conversion"}),(0,n.jsx)("dd",{children:(0,n.jsx)("div",{className:"text-lg font-medium text-secondary-900",children:v?"...":"".concat(t.conversion_rate,"%")})})]})})]})}),(0,n.jsx)("div",{className:"bg-secondary-50 px-5 py-3",children:(0,n.jsx)("div",{className:"text-sm",children:(0,n.jsx)("span",{className:"font-medium text-secondary-500",children:"Conversations converties en rendez-vous"})})})]}),(0,n.jsxs)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[(0,n.jsx)("div",{className:"p-5",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0 bg-red-100 rounded-md p-3",children:(0,n.jsx)("svg",{className:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,n.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{className:"text-sm font-medium text-secondary-500 truncate",children:"Rendez-vous annul\xe9s"}),(0,n.jsx)("dd",{children:(0,n.jsx)("div",{className:"text-lg font-medium text-secondary-900",children:v?"...":t.cancelled_appointments})})]})})]})}),(0,n.jsx)("div",{className:"bg-secondary-50 px-5 py-3",children:(0,n.jsx)("div",{className:"text-sm",children:(0,n.jsx)(l(),{href:"/dashboard/appointments?status=cancelled",className:"font-medium text-primary-700 hover:text-primary-900",children:"Voir les d\xe9tails"})})})]}),(0,n.jsxs)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[(0,n.jsx)("div",{className:"p-5",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0 bg-red-100 rounded-md p-3",children:(0,n.jsx)("svg",{className:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,n.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{className:"text-sm font-medium text-secondary-500 truncate",children:"Absences (no-show)"}),(0,n.jsx)("dd",{children:(0,n.jsx)("div",{className:"text-lg font-medium text-secondary-900",children:v?"...":t.no_show_appointments})})]})})]})}),(0,n.jsx)("div",{className:"bg-secondary-50 px-5 py-3",children:(0,n.jsx)("div",{className:"text-sm",children:(0,n.jsx)(l(),{href:"/dashboard/appointments?status=no_show",className:"font-medium text-primary-700 hover:text-primary-900",children:"Voir les d\xe9tails"})})})]})]}),(0,n.jsxs)("div",{className:"mt-8 grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,n.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,n.jsx)("div",{className:"px-5 py-4 border-b border-secondary-200",children:(0,n.jsx)("h3",{className:"text-lg leading-6 font-medium text-secondary-900",children:"Rendez-vous r\xe9cents"})}),(0,n.jsxs)("div",{className:"p-5",children:[v?(0,n.jsx)("div",{className:"animate-pulse space-y-4",children:[void 0,void 0,void 0].map((e,s)=>(0,n.jsx)("div",{className:"h-16 bg-secondary-100 rounded"},s))}):a.length>0?(0,n.jsx)("ul",{className:"divide-y divide-secondary-200",children:a.map(e=>(0,n.jsx)("li",{className:"py-4",children:(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("div",{className:"h-10 w-10 rounded-full flex items-center justify-center ".concat("confirmed"===e.status||"completed"===e.status?"bg-green-100 text-green-600":"cancelled"===e.status?"bg-red-100 text-red-600":"bg-yellow-100 text-yellow-600"),children:"confirmed"===e.status||"completed"===e.status?(0,n.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):"cancelled"===e.status?(0,n.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):(0,n.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-secondary-900 truncate",children:e.client_name}),(0,n.jsxs)("p",{className:"text-sm text-secondary-500",children:[(0,m.p6)(e.start_time,"PPP")," \xe0 ",(0,m.p6)(e.start_time,"HH:mm")]})]}),(0,n.jsx)("div",{children:(0,n.jsx)(l(),{href:"/dashboard/appointments/".concat(e.id),className:"inline-flex items-center shadow-sm px-2.5 py-0.5 border border-secondary-300 text-sm leading-5 font-medium rounded-full text-secondary-700 bg-white hover:bg-secondary-50",children:"Voir"})})]})},e.id))}):(0,n.jsx)("div",{className:"text-center py-4",children:(0,n.jsx)("p",{className:"text-sm text-secondary-500",children:"Aucun rendez-vous r\xe9cent"})}),a.length>0&&(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)(l(),{href:"/dashboard/appointments",className:"w-full flex justify-center items-center px-4 py-2 border border-secondary-300 shadow-sm text-sm font-medium rounded-md text-secondary-700 bg-white hover:bg-secondary-50",children:"Voir tous les rendez-vous"})})]})]}),(0,n.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,n.jsx)("div",{className:"px-5 py-4 border-b border-secondary-200",children:(0,n.jsx)("h3",{className:"text-lg leading-6 font-medium text-secondary-900",children:"Conversations r\xe9centes"})}),(0,n.jsxs)("div",{className:"p-5",children:[v?(0,n.jsx)("div",{className:"animate-pulse space-y-4",children:[void 0,void 0,void 0].map((e,s)=>(0,n.jsx)("div",{className:"h-16 bg-secondary-100 rounded"},s))}):h.length>0?(0,n.jsx)("ul",{className:"divide-y divide-secondary-200",children:h.map(e=>(0,n.jsx)("li",{className:"py-4",children:(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center text-primary-600",children:(0,n.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-secondary-900 truncate",children:e.client_name||e.client_phone}),(0,n.jsx)("p",{className:"text-sm text-secondary-500",children:(0,m.p6)(e.updated_at||new Date,"PPP")})]}),(0,n.jsx)("div",{children:(0,n.jsx)(l(),{href:"/dashboard/conversations/".concat(e.id),className:"inline-flex items-center shadow-sm px-2.5 py-0.5 border border-secondary-300 text-sm leading-5 font-medium rounded-full text-secondary-700 bg-white hover:bg-secondary-50",children:"Voir"})})]})},e.id))}):(0,n.jsx)("div",{className:"text-center py-4",children:(0,n.jsx)("p",{className:"text-sm text-secondary-500",children:"Aucune conversation r\xe9cente"})}),h.length>0&&(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)(l(),{href:"/dashboard/conversations",className:"w-full flex justify-center items-center px-4 py-2 border border-secondary-300 shadow-sm text-sm font-medium rounded-md text-secondary-700 bg-white hover:bg-secondary-50",children:"Voir toutes les conversations"})})]})]})]})]})]})]}):null}},390:function(e,s,t){"use strict";t.d(s,{p6:function(){return d}});var n=t(6585);function d(e,s){return(0,n.Z)(new Date(e),s)}}},function(e){e.O(0,[61,989,585,42,995,774,888,179],function(){return e(e.s=3391)}),_N_E=e.O()}]);